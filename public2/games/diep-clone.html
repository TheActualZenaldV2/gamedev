<!DOCTYPE html>
<canvas id="canvas"></canvas>

<style>
    canvas {
        border:1px solid #000;
        width: 100%;
        height: 100%;
        background-image: url("https://i.redd.it/5151vamxcmlx.png");
    }
    body {
        overflow: hidden;
        background-color: black;
    }
</style>
<script>
    var canvas = document.getElementById("canvas"),
        ctx = canvas.getContext("2d");

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvasWidth = canvas.width;
    canvasHeight = canvas.height;

    var x = 150,
        y = 150,
        velY = 0,
        velX = 0,
        speed = 1.5,
        friction = 0.8,
        keys = [],
        bullets = [],
        shooting = false;
    
    //get the mouse position
    var mouseX = 0,
        mouseY = 0;
    document.body.addEventListener("mousemove", function(e) {
        mouseX = e.clientX;
        mouseY = e.clientY;
    });

    var blocks = [];
    var blockX = Math.random() * canvasWidth;
    var blockY = Math.random() * canvasHeight;
    var randomBlockInterval = Math.random() * 2000;


    //movement
    function update() {
        requestAnimationFrame(update);

        if (keys[87]) {
            if (velY > -speed) {
                velY--;
            }
        }
        if (keys[83]) {
            if (velY < speed) {
                velY++;
            }
        }
        if (keys[68]) {
            if (velX < speed) {
                velX++;
            }
        }
        if (keys[65]) {
            if (velX > -speed) {
                velX--;
            }
        }

        velY *= friction;
        y += velY;
        velX *= friction;
        x += velX;

        //if the player goes off the screen, stop them
        //add padding of 10px
        if (y > canvas.height - 10) {
            y = canvas.height - 10;
            velY = 0;
        }
        if (y < 10) {
            y = 10;
            velY = 0;
        }
        if (x > canvas.width - 10) {
            x = canvas.width - 10;
            velX = 0;
        }
        if (x < 10) {
            x = 10;
            velX = 0;
        }

        //clear the canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        //update bullet positions
        for (var i = 0; i < bullets.length; i++) {
            bullets[i].x += bullets[i].velX;
            bullets[i].y += bullets[i].velY;

            //delete bullets if they go off screen
            if (bullets[i].y < 0 || bullets[i].y > canvasHeight || bullets[i].x < 0 || bullets[i].x > canvasWidth) {
                bullets.splice(i, 1);
            }
        }

        //draw the player and bullets
        drawPlayer();
    }

    function drawPlayer() {
        //draw the player
        ctx.fillStyle = "blue";
        ctx.beginPath();
        ctx.arc(x, y, 10, 0, 2 * Math.PI);
        ctx.fill();


        //(TURRET CODE)
        //draw a turret on top of the player
        //the turret should point in the direction of the mouse
        //the turret is a rectangle 
        //the turret should be 20px long and 5px wide
        

        //rotate the turret to point in the direction of the mouse
        //the turret should be rotated around the center of the player
        var angle = Math.atan2(mouseY - y, mouseX - x);
        //rotate ONLY the turret, not anything else 
        ctx.translate(x, y);
        ctx.rotate(angle);
        //draw the turret
        ctx.fillStyle = "black";
        ctx.beginPath();
        ctx.rect(5, -2, 20, 5);
        ctx.fill();
        //reset the rotation and translation
        ctx.rotate(-angle);
        ctx.translate(-x, -y);

        //(END OF TURRET CODE)





        //draw the bullets
        for (var i = 0; i < bullets.length; i++) {
            ctx.fillStyle = "red";
            ctx.beginPath();
            ctx.arc(bullets[i].x, bullets[i].y, 5, 0, 2 * Math.PI);
            ctx.fill();
        }

        //draw yellow blocks at random locations on the screen
        //the blocks should be 20px by 20px
        //the blocks should be randomly generated

        //update the blocks array
        //add a new block to the array every randomBlockInterval milliseconds
        //the block should be at a random location on the screen
        //the block should be 20px by 20px

         //draw the blocks
         function drawBlocks(){
         ctx.fillStyle = "yellow";
            ctx.beginPath();
            ctx.rect(blockX, blockY, 20, 20);
            ctx.fill();
            

            //update the blocks array
            //add a new block to the array every randomBlockInterval milliseconds
            blocks.push({
                x: blockX,
                y: blockY,
                width: 20,
                height: 20
            });
        }

            



        

       
        
            
            

        


    }

    //call the drawblocks function every 2 seconds



    //keyboard input
    document.body.addEventListener("keydown", function(e) {
        //keyboard input
document.body.addEventListener("keydown", function(e) {
    keys[e.keyCode] = true;

    //shoot when left click is pressed
    document.body.addEventListener("mousedown", function(e) {
        shoot();
    });
    if (e.keyCode == 32) {
        shoot();
    }
});
    });
    document.body.addEventListener("keyup", function(e) {
        keys[e.keyCode] = false;
    });

    //shooting
    //shooting
function shoot() {
    if (shooting) {
        return;
    }
    shooting = true;

    //create the bullet
    var bullet = {
        x: x,
        y: y,
        velX: 0,
        velY: 0
    };

    //add the bullet to the bullets array
    bullets.push(bullet);

    //make bullets shoot in the direction of the mouse
    var angle = Math.atan2(mouseY - y, mouseX - x);
    bullet.velX = Math.cos(angle) * 5;
    bullet.velY = Math.sin(angle) * 5;

    

    //draw the player and bullets
    drawPlayer();

    //reset shooting after 100ms
    setTimeout(function() {
        shooting = false;
    }, 100);
}

    //start the game
    update();
 

   

  


</script>
