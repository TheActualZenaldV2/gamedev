<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>3D First Person Shooter</title>
	<body>
		<div id="background"></div>
<div id="preGame">
    <div class="menu" id="startMenu">
      <h1>Game Menu</h1>
      <button onclick="startGame();">Start Game</button>
      <button onclick="openOptions();">Options</button>
      <button onclick="openControls()">Controls</button>
    </div>
 <div class="menu" id="optionsMenu" style="display: none;">
      <h1>Options</h1>
      <button onclick="toggleUI()"> <span id="ui"> Show UI Enabled</span></button> <br> <br>
      <label id="fov" for="fov-slider"><span id="fovValue"> FOV: 90</label>
  <input type="range" id="fov-slider" min="30" max="150" value="90" onchange="updateFOV(this.value);"> <br> <br>
  <label for="sensitivity-slider"> <span id="sensitivity"> Sensitivity: 1</span></label>
  <input type="range" id="sensitivity-slider" min="0.1" max="2" step="0.1" value="1" onchange="updateSensitivity(this.value);"> <br> <br>
      <button onclick="closeOptions();">Back</button>
  </div>

    <div id="controlsMenu" class="menu" style="display: none;">
      <h1> Controls</h1>
   <li> Use WASD to move </li>
   <li> Space To Jump</li>
   <li> Left Click to Shoot</li>
   <li> Move Mouse to Look Around</li>
   <li> Avoid Touching Enemies, They Kill You</li>
	    <li> Shoot Enemies Before They Shoot You</li>
	    <br>
    <button onclick="closeControls();">Back</button>
    </div>
</div>

<div id="endGame" style="display: none;">
  <div id="stats" class="menu">
    <h1> Game Over! </h1>
   <p> <i class="fa-solid fa-star"></i> Score: <span id="score-holder"></span> </p>
    <button onclick="location.reload()"> Play Again</button>
  </div>
</div>



<div id="gameUI">
    <div id="crosshair"></div>
    <div id="hud">
      <div id="ammo-count"><i class="fa-solid fa-crosshairs"></i><span id="ammo-count-value">10</span></div>
      <div id="score"><i class="fa-solid fa-star"></i><span id="score-value">0</span></div>
      <div id="health-bar">
        <div id="health-bar-number">Health: 100</div>
        <div id="health-bar-value"> <i class="fa-solid fa-heart" style="color: #ffffff;"></i>
          
          <div id="health-bar-value-inner">
          <div class="health-section"></div>
          <div class="health-section"></div>
          <div class="health-section"></div>
          <div class="health-section"></div>
          <div class="health-section"></div>
          </div>
        </div>
      </div>
    </div>
</div>
</body>

<style>
  /* import poppins font */
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');
  #background{
	position: absolute;
	width: 100%;
	height: 100%;
	background-image: linear-gradient(0deg, #D9AFD9 0%, #97D9E1 100%);	background-size: cover;
	background-repeat: no-repeat;
	background-position: center;
	z-index: -1;
  }
  body {
    margin: 0;
    overflow: hidden;
    font-family: 'Poppins', sans-serif;




  }
  canvas {
    width: 100%;
    height: 100%;
    display: block;
  }
  #crosshair {
    width: 20px;
    height: 20px;
    position: absolute;
    top: calc(50% - 10px);
    left: calc(50% - 10px);
  }
  #crosshair::before,
  #crosshair::after {
    content: "";
    position: absolute;
    width: 10px;
    height: 2px;
    background-color: #ffffff;
    top: calc(50% - 1px);
    left: calc(50% - 5px);
  }
  #crosshair::after {
    transform: rotate(90deg);
  }
  #hud {
        position: absolute;
        top: 10px;
        left: 10px;
        display: flex;
        flex-direction: row;
        gap: 10px;
        font-size: 24px;
        color: white;
        text-shadow: 1px 1px 1px black;
      }
      #ammo-count,
      #score {
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        color: white;
        text-shadow: 1px 1px 1px black;
      }
      #ammo-count-value,
      #score-value {
        margin-left: 5px;
      }
      #hud {
  background-color: rgba(122, 122, 122, 0.8);
  padding: 10px;
  border-radius: 10px;
}
#ammo-count {
  padding: 5px;
  border-radius: 5px;
  background-color: rgba(255, 255, 255, 0.5);
}

#score {
  padding: 5px;
  border-radius: 5px;
  background-color: rgba(255, 255, 255, 0.5);
}
#health-bar {
    width: 200px;
    height: 20px;
    padding: 12px;
    background-color: rgba(255, 255, 255, 0.5);
    border-radius: 2px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }
  #health-bar-value {
    position: absolute;
    top: 0;
    left: 0;
    padding: 5px;
    height: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .health-section {
    width: 20%;
    height: 100%;
    background-color: rgba(0, 255, 98, 0.5);
    border-radius: 6px;
    transition: width 0.2s ease-in-out;
    margin: 2.5px
  }
  #health-bar-value-inner {
    width: 80%;
    height: 80%;
    display: flex;
    justify-content: center;
    align-items: center;
    padding-bottom: 3%;
  }
  #health-bar-number {
    z-index: 99;
  }
  .menu {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.8);
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }

      .menu h1 {
        color: #fff;
        font-size: 36px;
        margin-top: 0;
      }

      .menu button {
        background-color: #fff;
        color: #000;
        border: none;
        padding: 10px 20px;
        font-size: 24px;
        border-radius: 5px;
        cursor: pointer;
        margin: 10px;
      }

      .menu button:hover {
        background-color: #000;
        color: #fff;
      }
      li {
        color: white;
        font-size: 20px;
        text-shadow: 1px 1px 1px black;

      }
      label {
        color: white;
        font-size: 20px;
        text-shadow: 1px 1px 1px black;
      }
      p {
        color: white;
        font-size: 20px;
        text-shadow: 1px 1px 1px black;
      }
</style>
    </style>
  </head>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.rawgit.com/mrdoob/three.js/r128/examples/js/controls/PointerLockControls.js"></script>
    <script src="https://kit.fontawesome.com/5e0a1eec4b.js" crossorigin="anonymous"></script>
    <script>

      gameStart = false;
      document.getElementById("gameUI").style.display = "none";
      showUI = true;
      let userFov;
      let userSenstivity;
      

      function startGame(){
        gameStart = true;
        document.getElementById("gameUI").style.display = "block";
        document.getElementById("startMenu").style.display = "none";
        gameStartFunction();
        if(showUI == false){
          document.getElementById("gameUI").style.display = "none";
      }
    }
      function openOptions(){
        document.getElementById("optionsMenu").style.display = "block";
        document.getElementById("startMenu").style.display = "none";
      }
      function toggleUI(){
        if(showUI == false){
          document.getElementById("ui").innerHTML = "Show UI Enabled";
          showUI = true;
        }else{
          document.getElementById("gameUI").style.display = "none";
          document.getElementById("ui").innerHTML = "Show UI Disabled";
          showUI = false;
        }
      }
      function closeOptions(){
        document.getElementById("optionsMenu").style.display = "none";
        document.getElementById("startMenu").style.display = "block";
      }
      function openControls(){
        document.getElementById("controlsMenu").style.display = "block";
        document.getElementById("startMenu").style.display = "none";
      }
      function closeControls(){
        document.getElementById("controlsMenu").style.display = "none";
        document.getElementById("startMenu").style.display = "block";
      }
      function updateFOV(value){
        userFov = value;
        document.getElementById("fovValue").innerHTML = "FOV: " + userFov;
      }
      function updateSensitivity(value1) {
  userSenstivity = value1;
  mouseSensitivity = userSenstivity;
  document.getElementById("sensitivity").innerHTML = "Sensitivity: " + userSenstivity;
}
     function gameStartFunction(){

      // Set up the scene, camera, and renderer
      const scene = new THREE.Scene();
      // Create the camera
const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 10000);
camera.position.set(0, 1.6, -3);
camera.lookAt(0, 1.6, 0);

// Set the camera's field of view to a wider angle
if(!userFov){
  userFov = 90;
}
camera.fov = userFov;
camera.updateProjectionMatrix();
      let score = 0;
      let health = 100;
      let enemyNumber = 5;
      let gameOver = false;
      const renderer = new THREE.WebGLRenderer();
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

     //give the canvas id of canvas
      renderer.domElement.id = "canvas";

      // Create the floor object
      const floorGeometry = new THREE.PlaneGeometry(150, 150);
      const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x333333 });
      const floor = new THREE.Mesh(floorGeometry, floorMaterial);
      floor.rotation.x = -Math.PI / 2;
      scene.add(floor);


      const loader = new THREE.ObjectLoader();
     const mapData = {
	"metadata": {
		"version": 4.6,
		"type": "Object",
		"generator": "Object3D.toJSON"
	},
	"geometries": [
		{
			"uuid": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
			"type": "BoxGeometry",
			"width": 1,
			"height": 1,
			"depth": 1,
			"widthSegments": 1,
			"heightSegments": 1,
			"depthSegments": 1
		}],
	"materials": [
		{
			"uuid": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98",
			"type": "MeshStandardMaterial",
			"color": 0,
			"roughness": 1,
			"metalness": 0,
			"emissive": 7039851,
			"envMapIntensity": 1,
			"vertexColors": true,
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "642ff8aa-a3b6-41a7-908b-1f85c31340c0",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "54a87d7b-bbf6-4120-9b5e-57565b5e265b",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "2447863e-2351-4509-804d-50f7842cfcbc",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "a271fc73-c2b3-4e53-9450-920afeb147a6",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "b773ade2-1786-41a4-a139-b4b70657c190",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "3df052c9-e231-471a-8975-0257975c3606",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "1d16ce03-0f37-4ad0-8127-f173dca9684d",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "db62666b-3425-4c6a-8b48-b604794c5a52",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "b83071d9-80d6-47af-8d2b-79f15455d5f4",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "b379bad6-1370-4ece-95a3-f8f396973df6",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "f4cb52ff-91e5-4dc2-b3e9-9de7bce3f3fb",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "661f4ab6-d1e1-41a9-98ad-44b359aee536",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "de75d46e-e890-407d-896a-7c179cfe5324",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "a14741e2-c94a-4aa3-bfc5-899e4c37f49b",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "d094aa03-334e-4b82-b34d-b75b187f0455",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "028f3a3e-2721-4c1e-a9f9-dd956a85513e",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "61318bfa-e9da-4532-9841-14641bee6d5b",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "ce47758c-4f3d-4145-aa07-265cafc1eace",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "93b571be-6031-4784-817c-1d1ae07e70ee",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "241664ae-f5d1-4284-8e5a-842d45a2eb8b",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "217da436-a916-42e9-b489-57050319e26e",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "7a270282-e655-442a-8428-a8cad621930b",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "6b0cc7f4-75b0-45c4-b986-cf6def9eded1",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "990dc75f-2c7d-4707-89ff-d4fde0f45f8a",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "7edc1e23-33c2-42c2-a998-8df429d6e922",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "561a59d2-df54-4dbf-ae63-caba866c1a46",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "706e84af-a454-434f-87ee-36e46c1bf31d",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "152aebf7-7b6c-418c-b595-31a1731a8214",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "bd542e7c-77ba-47c1-b36d-c344b315485c",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		},
		{
			"uuid": "d08b245d-4c16-4f6f-ad6d-64a49a348186",
			"type": "MeshNormalMaterial",
			"depthFunc": 3,
			"depthTest": true,
			"depthWrite": true,
			"colorWrite": true,
			"stencilWrite": false,
			"stencilWriteMask": 255,
			"stencilFunc": 519,
			"stencilRef": 0,
			"stencilFuncMask": 255,
			"stencilFail": 7680,
			"stencilZFail": 7680,
			"stencilZPass": 7680
		}],
	"object": {
		"uuid": "9d870c3b-fd55-4fc6-a7a2-a189b7e0d714",
		"type": "Scene",
		"name": "Scene",
		"layers": 1,
		"matrix": [1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],
		"up": [0,1,0],
		"children": [
			{
				"uuid": "9c2ab895-2f84-41db-be4f-2f918099de8a",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [7.932056841443746e-15,0,35.72280823540765,0,0,3.9037274670948845,0,0,-3.1384631203652242,0,6.968788036332772e-16,0,-43.41843073509929,2,0.30681450107626096,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "1028b2b1-1829-44c5-91ae-671c95b1ff13",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [2.9570387900171406e-15,0,13.317318792841297,0,0,15.587641024357756,0,0,-19.77692311425659,0,4.391359079537824e-15,0,41.605257908292515,2,-0.3344763381706516,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "642ff8aa-a3b6-41a7-908b-1f85c31340c0"
			},
			{
				"uuid": "16089d95-8e9c-400a-ad71-8d6801e27a62",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-49.147257330309685,-5.9462602331555025e-15,0.5959710774339351,0,-4.780335896754834e-16,3.9037274670948845,-4.722719882001005e-16,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.035659953711531855,2,31.486453738606293,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "2972b615-1bec-4c49-b126-61048b97d288",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-0.13602928979179407,-8.331404261581523e-18,17.88945838581072,0,-4.781773338103943e-16,3.9037274670948845,-1.8179751871722645e-18,0,-3.1383723929207132,-3.844381913974468e-16,-0.0238638061871,0,22.707525177461292,1.9999999999999984,24.157056131685984,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "3d3008e1-6b84-4b96-8403-a4b575f7f698",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-0.13602928979179407,-8.331404261581523e-18,17.88945838581072,0,-4.781773338103943e-16,3.9037274670948845,-1.8179751871722645e-18,0,-3.1383723929207132,-3.844381913974468e-16,-0.0238638061871,0,-22.914673249987654,1.9999999999999927,24.64752099683631,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "3f7b014a-3a12-467f-87c1-8a96fbcf3814",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-17.889975553514176,-2.1908901298435535e-15,2.6830665847964366e-31,0,-4.780687347321355e-16,3.9037274670948845,-4.780687347321355e-16,0,0,-3.843508814597286e-16,-3.1384631203652242,0,-33.183178836559534,1.9999999999999916,17.492646831532994,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "afcaa773-e216-46cb-b1bc-48e0459fa289",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-72.33045654032452,-8.857926208297516e-15,1.0847830978075004e-30,0,-4.780687347321355e-16,3.9037274670948845,-4.780687347321355e-16,0,0,-3.843508814597286e-16,-3.1384631203652242,0,57.459758312104306,1.9999999999999987,-16.99838400490104,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "1034df75-5fdb-4b60-8a41-0290a025bf20",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-0.16860925840862565,-1.032683399433925e-17,22.174109093565775,0,-4.781773338103943e-16,3.9037274670948845,-1.8179751871722645e-18,0,-3.729420679718759,-4.568392662086287e-16,-0.028358066267637996,0,23.106309343224602,1.9999999999999984,-28.28777210539717,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "b9c31366-5e57-45d6-9d6e-f69f2d5d31de",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-57.755641817414876,-6.9877770364913075e-15,0.7003583506293756,0,-4.780335896754834e-16,3.9037274670948845,-4.722719882001005e-16,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.8455383566196966,1.9999999999999918,-35.3008515201797,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "8963beb7-22a1-45df-b7c4-5e13355806d7",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-0.13602928979179407,-8.331404261581523e-18,17.88945838581072,0,-4.781773338103943e-16,3.9037274670948845,-1.8179751871722645e-18,0,-3.1383723929207132,-3.844381913974468e-16,-0.0238638061871,0,-22.535283034544683,1.9999999999999927,-25.24677369174982,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "d60e89fb-99e9-428c-9f2c-893898e52978",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-27.289461473549533,-3.341995164403745e-15,4.092763680852978e-31,0,-4.780687347321355e-16,3.9037274670948845,-4.780687347321355e-16,0,0,-3.843508814597286e-16,-3.1384631203652242,0,-34.952413255604995,1.9999999999999871,-16.99838400490104,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "88d4fe78-c6b2-466d-9a0b-5af81c70649b",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-50.588810807891264,-6.195342522855507e-15,7.587106390236483e-31,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,49.27723886573345,5.952347120249387,-31.337270051617104,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "54a87d7b-bbf6-4120-9b5e-57565b5e265b"
			},
			{
				"uuid": "98486641-18df-45f6-af7e-cc8f8df68e3f",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-17.74856236926754,-2.1735720094990654e-15,2.661858004149311e-31,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-33.29637068387053,5.952347120249385,30.901823146533644,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "2447863e-2351-4509-804d-50f7842cfcbc"
			},
			{
				"uuid": "ceec2b15-a55c-449e-96b3-e360898676bb",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-17.74856236926754,-2.1735720094990654e-15,2.661858004149311e-31,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-33.29637068387053,5.952347120249377,-30.5055374427193,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "a271fc73-c2b3-4e53-9450-920afeb147a6"
			},
			{
				"uuid": "e7824de6-7bb4-45e4-84c4-2000b2254b3d",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-12.547880978677842,-1.5366722276619778e-15,1.8818807249448738e-31,0,-7.8536139850451e-15,64.12962488868702,-7.8536139850451e-15,0,0,-1.8335889682016863e-15,-14.972390157540136,0,-35.17136782405482,11.90616177980057,-30.5055374427193,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "b773ade2-1786-41a4-a139-b4b70657c190"
			},
			{
				"uuid": "b4f2e674-23d4-4aa0-b632-61ef5660c064",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-12.547880978677842,-1.5366722276619778e-15,1.8818807249448738e-31,0,-8.05012957297075e-15,65.73429644021088,-8.05012957297075e-15,0,0,-1.8335889682016863e-15,-14.972390157540136,0,33.91646887870589,11.906161779800579,-30.5055374427193,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "3df052c9-e231-471a-8975-0257975c3606"
			},
			{
				"uuid": "ea8f9d45-fd8a-43bd-820d-0939c405b266",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-12.547880978677842,-1.5366722276619778e-15,1.8818807249448738e-31,0,-8.43270825827812e-15,68.85828848080361,-8.43270825827812e-15,0,0,-1.8335889682016863e-15,-14.972390157540136,0,33.91646887870589,11.906161779800586,30.40109758864564,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "1d16ce03-0f37-4ad0-8127-f173dca9684d"
			},
			{
				"uuid": "d4725d40-e937-4ead-9354-8aa42c2c861f",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-12.547880978677842,-1.5366722276619778e-15,1.8818807249448738e-31,0,-8.280217612048144e-15,67.61310785945102,-8.280217612048144e-15,0,0,-1.8335889682016863e-15,-14.972390157540136,0,-33.09316341817205,11.906161779800577,30.40109758864564,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "db62666b-3425-4c6a-8b48-b604794c5a52"
			},
			{
				"uuid": "8548784f-c914-4a35-aabb-e2af2829890e",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-157.64558710098655,-1.9306016364292845e-14,2.3643051144817654e-30,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-0.768471018776772,5.952347120249376,-74.85847008178656,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "b83071d9-80d6-47af-8d2b-79f15455d5f4"
			},
			{
				"uuid": "a37193ce-812e-4794-ad2a-560c3ee67587",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-157.64558710098655,-1.9306016364292845e-14,2.3643051144817654e-30,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-0.768471018776772,5.952347120249394,75.66554671645585,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "b379bad6-1370-4ece-95a3-f8f396973df6"
			},
			{
				"uuid": "b83af6e3-d884-482e-b89e-7cd1ddcca491",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-7.207216232851958,-4.593961587840061e-16,157.48075173362506,0,-2.402952125934261e-15,18.859163488856975,-5.495762630583811e-17,0,-27.6810235202219,-3.5306866577979654e-15,-1.266841311466146,0,80.05652579298778,5.952347120249394,-3.4983589821475984,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "f4cb52ff-91e5-4dc2-b3e9-9de7bce3f3fb"
			},
			{
				"uuid": "53ab1779-f951-4889-bf11-0810728f2920",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-7.207216232851958,-4.593961587840061e-16,157.48075173362506,0,-2.402952125934261e-15,18.859163488856975,-5.495762630583811e-17,0,-27.6810235202219,-3.5306866577979654e-15,-1.266841311466146,0,-90.24326195850237,5.952347120249373,-11.292247322291393,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "661f4ab6-d1e1-41a9-98ad-44b359aee536"
			},
			{
				"uuid": "12983577-58a9-47c0-bb0b-e84a68d5b53e",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [1.6966788275633788,1.0814823794517028e-16,-37.07315676159135,0,-6.532077098216339e-15,51.26590271505499,-1.4939434218862083e-16,0,-27.6810235202219,-3.5306866577979654e-15,-1.266841311466146,0,-106.49686308728619,20.270022310416447,-12.036104692846854,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "de75d46e-e890-407d-896a-7c179cfe5324"
			},
			{
				"uuid": "2a2ad519-cada-4e91-a1aa-7f998cb8b84e",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [1.6966788275633788,1.0814823794517028e-16,-37.07315676159135,0,-6.532077098216339e-15,51.26590271505499,-1.4939434218862083e-16,0,-27.6810235202219,-3.5306866577979654e-15,-1.266841311466146,0,107.26502634279174,20.270022310416476,-2.253143013368108,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "a14741e2-c94a-4aa3-bfc5-899e4c37f49b"
			},
			{
				"uuid": "e5023e4e-6f08-4c89-9d5d-65290265db21",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [44.43299765061215,5.441472834934404e-15,-6.663882289949691e-31,0,-6.863396905095122e-15,56.043888816544374,-6.863396905095122e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-0.7684710187767742,22.931823105324224,-100.67151976628942,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "d094aa03-334e-4b82-b34d-b75b187f0455"
			},
			{
				"uuid": "5860f51f-fef1-4993-8242-118db4dd5bc4",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [44.43299765061215,5.441472834934404e-15,-6.663882289949691e-31,0,-6.863396905095122e-15,56.043888816544374,-6.863396905095122e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,-0.7684710187767742,22.93182310532425,99.80949780657134,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "028f3a3e-2721-4c1e-a9f9-dd956a85513e"
			},
			{
				"uuid": "6c43df7e-aa6a-421f-be78-cc3e54c3078b",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-14.96169995474618,-1.8101958541325402e-15,0.18142905477604915,0,-4.780335896754834e-16,3.9037274670948845,-4.722719882001005e-16,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.5577407455229383,1.9999999999999947,-11.567378895094595,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "61318bfa-e9da-4532-9841-14641bee6d5b"
			},
			{
				"uuid": "7abcaabf-1091-4ffb-82e1-e3c5a093c3ee",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-14.96169995474618,-1.8101958541325402e-15,0.18142905477604915,0,-4.780335896754834e-16,3.9037274670948845,-4.722719882001005e-16,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.2746681093500887,1.9999999999999976,11.77644468952957,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "ce47758c-4f3d-4145-aa07-265cafc1eace"
			},
			{
				"uuid": "8b4e054b-509e-4723-8060-fd0848a41b0f",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-3.3224090011999044e-15,-3.276148215251243e-46,-14.962799939776271,0,-1.0887669533663299e-30,3.9037274670948845,8.547323913722921e-47,0,3.1384631203652242,8.753313233609438e-31,-6.968788036332772e-16,0,16.34426246279509,1.999999999999996,0.06175307214117787,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "93b571be-6031-4784-817c-1d1ae07e70ee"
			},
			{
				"uuid": "60450574-f62e-480a-ade6-a569e1532992",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-3.3224090011999044e-15,-3.276148215251243e-46,-14.962799939776271,0,-1.0887669533663299e-30,3.9037274670948845,8.547323913722921e-47,0,3.1384631203652242,8.753313233609438e-31,-6.968788036332772e-16,0,-16.64127413018708,1.999999999999996,0.06175307214118497,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "241664ae-f5d1-4284-8e5a-842d45a2eb8b"
			},
			{
				"uuid": "9f53c859-970a-410a-b8da-952f07c81826",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-6.0331008399212855,-7.299367158158153e-16,0.07315878450084023,0,-1.4884273649199455e-15,12.154825335931092,-1.4704877776462883e-15,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.2746681093500891,5.6888131165006,11.77644468952957,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "217da436-a916-42e9-b489-57050319e26e"
			},
			{
				"uuid": "04af6f53-08a1-489e-bf8b-1212b71cfdd0",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-6.0331008399212855,-7.299367158158153e-16,0.07315878450084023,0,-1.4884273649199455e-15,12.154825335931092,-1.4704877776462883e-15,0,-0.03805493621976919,-3.8432262603844325e-16,-3.138232397341205,0,-0.5580122163094966,5.688813116500597,-11.589765962369857,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "7a270282-e655-442a-8428-a8cad621930b"
			},
			{
				"uuid": "0ce5d5a6-4800-4383-8696-6d46666b3f76",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-1.252243435903801e-15,-1.2348073630051782e-46,-5.639603071313508,0,-3.30655161247983e-30,11.855499756945111,2.595795875501629e-46,0,3.1384631203652242,8.753313233609438e-31,-6.968788036332772e-16,0,-16.64127413018708,5.774232760671483,0.06175307214118497,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "6b0cc7f4-75b0-45c4-b986-cf6def9eded1"
			},
			{
				"uuid": "b9ed9db7-aae2-4d22-bc6d-ef6be78d01bd",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-1.252243435903801e-15,-1.2348073630051782e-46,-5.639603071313508,0,-3.30655161247983e-30,11.855499756945111,2.595795875501629e-46,0,3.1384631203652242,8.753313233609438e-31,-6.968788036332772e-16,0,16.341438379856,5.774232760671483,0.06175307214118275,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "990dc75f-2c7d-4707-89ff-d4fde0f45f8a"
			},
			{
				"uuid": "54d5ee94-5026-471e-8aeb-4f6f7082d649",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-72.33045654032452,-8.857926208297516e-15,1.0847830978075004e-30,0,-4.780687347321355e-16,3.9037274670948845,-4.780687347321355e-16,0,0,-3.843508814597286e-16,-3.1384631203652242,0,57.459758312104306,2.0000000000000027,15.61671512441675,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "47146d15-0576-4617-b183-dbbb97bdd767",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [-50.588810807891264,-6.195342522855507e-15,7.587106390236483e-31,0,-2.3095814201225327e-15,18.859163488856975,-2.3095814201225327e-15,0,0,-3.393495949052373e-15,-27.70999729403659,0,49.27723886573345,5.952347120249395,30.75043681015503,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "7edc1e23-33c2-42c2-a998-8df429d6e922"
			},
			{
				"uuid": "2d4a529e-48e6-447c-8f2b-4e6a1a45dd9b",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [2.9570387900171406e-15,0,13.317318792841297,0,0,15.587641024357756,0,0,-19.77692311425659,0,4.391359079537824e-15,0,68.69542285477645,2,-0.3344763381706569,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "561a59d2-df54-4dbf-ae63-caba866c1a46"
			},
			{
				"uuid": "2b35fc8d-af1a-4596-8a07-eefe595d55c5",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [1.781594906041485e-15,0,8.023590154973606,0,0,15.587641024357756,0,0,-6.504776851640533,0,1.4443506061480111e-15,0,60.68873039367003,2,-0.33447633817065536,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "706e84af-a454-434f-87ee-36e46c1bf31d"
			},
			{
				"uuid": "1897d452-4b3f-4eeb-aecd-414ec97bb840",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [1.781594906041485e-15,0,8.023590154973606,0,0,15.587641024357756,0,0,-6.504776851640533,0,1.4443506061480111e-15,0,49.38383407267673,2,-0.3344763381706536,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "07d621a7-4d86-41a3-bd7e-181a7fe2baf9",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [7.343655889246214e-16,0,3.30728859263464,0,0,15.587641024357756,0,0,-4.626421378461744,0,1.0272719071972568e-15,0,58.59459228877436,2,-0.3344763381706549,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "152aebf7-7b6c-418c-b595-31a1731a8214"
			},
			{
				"uuid": "18e3373b-b395-4290-934b-7542f7b36829",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [7.343655889246214e-16,0,3.30728859263464,0,0,15.587641024357756,0,0,-4.626421378461744,0,1.0272719071972568e-15,0,51.37292430330758,2,-0.3344763381706536,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "c5ab2d01-e6b0-4a36-805d-62d7f2fc0b98"
			},
			{
				"uuid": "08afa65b-a10f-40d0-99fc-3686a9177582",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [1.781594906041485e-15,0,8.023590154973606,0,0,15.587641024357756,0,0,-6.504776851640533,0,1.4443506061480111e-15,0,33.519515592749286,2,-0.3344763381706509,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "bd542e7c-77ba-47c1-b36d-c344b315485c"
			},
			{
				"uuid": "3d0f9e44-1145-4106-9be7-9dac21b32e3a",
				"type": "Mesh",
				"name": "Box",
				"layers": 1,
				"matrix": [7.343655889246214e-16,0,3.30728859263464,0,0,15.587641024357756,0,0,-4.626421378461744,0,1.0272719071972568e-15,0,30.91587893693002,2,-0.33447633817065003,1],
				"up": [0,1,0],
				"geometry": "f456f77f-b0c9-441b-86c1-a5a7f1214244",
				"material": "d08b245d-4c16-4f6f-ad6d-64a49a348186"
			}]
	}
}
  
  loader.parse(mapData, (object) => {
  // Add the loaded object to the scene
  scene.add(object);
});


// Create bounding boxes for collision detection
const boundingBoxes = [];
scene.traverse((node) => {
  if (node.isMesh) {
    const box = new THREE.Box3().setFromObject(node);
    boundingBoxes.push(box);
  }
});

// Detect collisions
function detectCollisions() {
  //get origin point but take into account velocity
  const originPoint = controls.getObject().position.clone();
  for (let box of boundingBoxes) {
    if (box.containsPoint(originPoint)) {
      return true;
    }
  }
  return false;
}

//detect collison between bullets and walls
function detectBulletCollisions() {
  for (let bullet of bullets) {
	const originPoint = bullet.position.clone();
	for (let box of boundingBoxes) {
	  if (box.containsPoint(originPoint)) {
		return true;
	  }
	}
  }
  return false;
}
function detectEnemyBulletCollisions() {
  for (let bullet of enemyBullets) {
    // Origin point of enemy bullet
    const originPoint = bullet.position.clone();
    for (let box of boundingBoxes) {
      if (box.containsPoint(originPoint)) {
        return true;
      }
    }
  }
  return false;
}

 // Create the enemies
 const enemyGeometry = new THREE.BoxGeometry(1, 1, 1);
    const enemyMaterial = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
    const enemies = [];
    for (let i = 0; i < 10; i++) {
      const enemy = new THREE.Mesh(enemyGeometry, enemyMaterial);
      enemy.position.set(Math.random() * 20 - 10, 0.5, Math.random() * 20 - 10);
      scene.add(enemy);
      enemies.push(enemy);
    }
   
  //set time variable to higher as time goes on
let time = 0;
setInterval(() => {
  time += 10;
}, 100);

// Create enemies at random intervals
setInterval(() => {
  const numEnemies = Math.floor(Math.random() * enemyNumber) + 1; // Generate a random number of enemies between 1 and 5
  for (let i = 0; i < numEnemies; i++) {
    const enemy = new THREE.Mesh(enemyGeometry, enemyMaterial);
    enemy.position.set(Math.random() * 20 - 10, 0.5, Math.random() * 20 - 10);
    scene.add(enemy);
    enemies.push(enemy);
  }
}, Math.random() * 1000 + 5000 - time);



   function moveEnemies() {
  // Move enemies towards player
  for (let enemy of enemies) {
    //move in direction of player slowly 
    enemy.position.lerp(controls.getObject().position, 0.01);

  }
}
let enemyBullets = [];
function enemyShooting() {
  // Give each enemy 10% chance of shooting every second
  for (let enemy of enemies) {
    if (Math.random() < 0.1) {
      const bullet = new THREE.Mesh(bulletGeometry, new THREE.MeshBasicMaterial({ color: 0xff0000 }));
      // Set bullet velocity in direction of player
      const playerPosition = controls.getObject().position.clone();
      const enemyPosition = enemy.position.clone();
      const direction = playerPosition.sub(enemyPosition).normalize();
      bullet.position.copy(enemyPosition);
      bullet.velocity = direction.multiplyScalar(0.1);
      scene.add(bullet);
      enemyBullets.push(bullet);
    }
  }
}

setInterval(() => {
	enemyShooting();
}, 500);
// Add bullets
const bullets = [];
const bulletGeometry = new THREE.SphereGeometry(0.1, 8, 8);
const bulletMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
let ammoCount = 10; // Set initial ammo count
const ammoCountElement = document.getElementById('ammo-count-value'); // Get ammo count element
ammoCountElement.textContent = `Ammo: ${ammoCount}`; // Update ammo count element

let shootTimeout = null; // Initialize shoot timeout variable

// On mousedown, start shooting
document.addEventListener('mousedown', () => {
  shootTimeout = setInterval(() => {
    if (ammoCount > 0) { // Check if there is ammo left
      const bullet = new THREE.Mesh(bulletGeometry, bulletMaterial);
      //set bullet posiiton to camera position
      bullet.position.copy(camera.position);
      //add velocity to bullet
      bullet.velocity = new THREE.Vector3();
      //set bullet velocity in direction of camera
      camera.getWorldDirection(bullet.velocity);
      bullet.velocity.multiplyScalar(0.2);
if (!bullet.velocity || bullet.velocity.length() === 0) return; 
     bullets.push(bullet);
      scene.add(bullet);

      ammoCount--; // Decrement ammo count
      ammoCountElement.textContent = `Ammo: ${ammoCount}`; // Update ammo count element
    }
    if (ammoCount == 0) {
      ammoCountElement.style.color = 'red'; // Update ammo count element
    }
  }, 150);
});

// On mouseup, stop shooting
document.addEventListener('mouseup', () => {
  clearInterval(shootTimeout);
});
//on click shoot with 150ms delay
document.addEventListener('click', () => {
  setTimeout(() => {
    if (ammoCount > 0) { // Check if there is ammo left
      const bullet = new THREE.Mesh(bulletGeometry, bulletMaterial);
      //set bullet posiiton to camera position
      bullet.position.copy(camera.position);
      //add velocity to bullet
      bullet.velocity = new THREE.Vector3();
      //set bullet velocity in direction of camera
      camera.getWorldDirection(bullet.velocity);
      bullet.velocity.multiplyScalar(0.2);

      bullets.push(bullet);
      scene.add(bullet);

      ammoCount--; // Decrement ammo count
      ammoCountElement.textContent = `Ammo: ${ammoCount}`; // Update ammo count element
    }
    if (ammoCount == 0) {
      ammoCountElement.style.color = 'red'; // Update ammo count element
    }
  }, 150);
});


// On key press, reload if 'r' is pressed
document.addEventListener('keydown', (event) => {
  if (event.key === 'r') {
    setTimeout(() => {
      ammoCount = 10; // Reset ammo count
    ammoCountElement.textContent = `Ammo: ${ammoCount}`; // Update ammo count element
    ammoCountElement.style.color = 'white'; // Update ammo count element
    }, 1000);
    ammoCountElement.textContent = 'Reloading...'; // Update ammo count element
    ammoCountElement.style.color = 'red'; // Update ammo count element
    ammoCount = 0;
  }
});








// Set up the controls
const controls = new THREE.PointerLockControls(camera, document.body);

const lockControls = () => {
  controls.lock();
  document.removeEventListener("click", lockControls);
};

document.addEventListener("click", lockControls);

scene.add(controls.getObject());
	
      controls.mouseSensitivity = userSenstivity;


      // Set up the lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
      scene.add(ambientLight);
      const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
      directionalLight.position.set(1, 1, 0);
      scene.add(directionalLight);

      // Set up the raycaster for collision detection
      const raycaster = new THREE.Raycaster();
      const direction = new THREE.Vector3();

    const keyboard = new Map();
    let isJumping = false;
let jumpVelocity = 0;
const jumpSpeed = 0.2;
const jumpHeight = 0.9;
// Load the skybox texture
const textureLoader = new THREE.TextureLoader();
const texture = textureLoader.load('https://i.imgur.com/1pJKDTj.jpg');

// Create the skybox geometry
const skyboxGeometry = new THREE.SphereGeometry(1000, 32, 32);

// Create the skybox material with the loaded texture
const skyboxMaterial = new THREE.MeshStandardMaterial({ map: texture, side: THREE.BackSide });
// Create the skybox mesh
const skybox = new THREE.Mesh(skyboxGeometry, skyboxMaterial);
skybox.position.set(0, 500, 0);
// Add the skybox to the scene
scene.add(skybox);

// Set up the animation loop
function animate() {
  requestAnimationFrame(animate);
 // Update bullet positions
 bullets.forEach((bullet) => {
        bullet.position.add(bullet.velocity);
      });

	  //enemy bullets 
	  enemyBullets.forEach((enemyBullet) => {
		enemyBullet.position.add(enemyBullet.velocity);
	  });
  // Move the player based on keyboard input
 let speed = 0.05;
  
  const forward = new THREE.Vector3(
    controls.getObject().matrix.elements[8],
    0,
    controls.getObject().matrix.elements[10]
  );
  const backward = forward.clone().negate();
  const left = new THREE.Vector3(
    controls.getObject().matrix.elements[0],
    0,
    controls.getObject().matrix.elements[2]
  );
  const right = left.clone().negate();
  const velocity = new THREE.Vector3();


  document.addEventListener("keydown", (event) => {
    keyboard.set(event.key, true);
    if (event.key === " ") {
      if (!isJumping) {
        isJumping = true;
        jumpVelocity = jumpSpeed;
      }
    }
   
  });

  document.addEventListener("keyup", (event) => {
    keyboard.set(event.key, false);
   
  });

  if (keyboard.get("w")) {
    velocity.add(backward);
  }
  if (keyboard.get("s")) {
    velocity.add(forward);
  }
  if (keyboard.get("a")) {
    velocity.add(right);
  }
  if (keyboard.get("d")) {
    velocity.add(left);
  }

  if (isJumping) {
    jumpVelocity -= 0.006;
    controls.getObject().position.y += jumpVelocity /2;
    if (controls.getObject().position.y < jumpHeight) {
      controls.getObject().position.y = 1;
      isJumping = false;
      jumpVelocity = 0;
    }
  }

  velocity.normalize();
  velocity.multiplyScalar(speed);
  controls.getObject().position.add(velocity);

  // Check for collisions with the floor
  raycaster.set(
    controls.getObject().position,
    new THREE.Vector3(0, -1, 0)
  );
  const intersects = raycaster.intersectObject(floor);
  if (intersects.length > 0) {
    const distance = intersects[0].distance;
    if (distance < 1) {
      controls.getObject().position.y += 1 - distance;
      isJumping = false;
      jumpVelocity = 0;
    }
  }
 

  // Render the scene
  renderer.render(scene, camera);

  //stop player from moving through walls
  if (detectCollisions()) {
    controls.getObject().position.sub(velocity);

  }
 moveEnemies();

 //bullet collisions with enemies
  bullets.forEach((bullet) => {
        for (let enemy of enemies) {
          if (bullet.position.distanceTo(enemy.position) < 0.5) {
            scene.remove(enemy);
            enemies.splice(enemies.indexOf(enemy), 1);
            scene.remove(bullet);
            bullets.splice(bullets.indexOf(bullet), 1);
            score ++;
            document.getElementById("score-value").innerHTML = "Score: " + score;
          }
        }
      });
//collision detection for enemy bullets
enemyBullets.forEach((enemyBullet) => {
		if (enemyBullet.position.distanceTo(controls.getObject().position) < 0.5) {
		  health -= 10;
		  scene.remove(enemyBullet);
		  enemyBullets.splice(enemyBullets.indexOf(enemyBullet), 1);
		  document.getElementById("health-bar-number").innerHTML = "Health: " + health;


		}
	  });

      if (health < 0  && gameOver == false || health == 0 && gameOver == false) {
  gameOver = true;
  
  document.getElementById("endGame").style.display = "block";
  //hide the canvas
  document.getElementById("canvas").style.display = "none";
  //exit pointer lock
  document.exitPointerLock();
  //stop the animation
  cancelAnimationFrame(animate);
  //hide UI
  document.getElementById("gameUI").style.display = "none";
  document.getElementById("score-holder").innerHTML = score;
  controls.unlock();
  
}

updateHealth();

//detect bullet collisions with walls
bullets.forEach((bullet) => {
		if (detectBulletCollisions(bullet)) {
		  scene.remove(bullet);
		  bullets.splice(bullets.indexOf(bullet), 1);
		}
	  });
//detect enemy bullet collisions with walls
enemyBullets.forEach((enemyBullet) => {
		if (detectBulletCollisions(enemyBullet)) {
		  scene.remove(enemyBullet);
		  enemyBullets.splice(enemyBullets.indexOf(enemyBullet), 1);
		}
	  });


}

function updateHealth(){
	//change health bar color based on health
//health bar is a class called health section

const healthBarValue = document.getElementById("health-bar-value");
const healthSections = healthBarValue.querySelectorAll(".health-section");
  const numSections = healthSections.length;
  const sectionWidth = 100 / numSections;
  const remainingSections = Math.floor((health / 100) * numSections);
  for (let i = 0; i < numSections; i++) {
    if (i < remainingSections) {
      healthSections[i].style.width = sectionWidth + "%";
    } else {
      healthSections[i].style.width = "0";
    }
    //update the health bar value
    document.getElementById("health-bar-number").innerHTML = "Health: " + health;
  }


if (health > 80) {
  for (let i = 0; i < healthSections.length; i++) {
    healthSections[i].style.backgroundColor = "green";
  }
} else if (health > 60 && health <= 80) {
  for (let i = 0; i < healthSections.length; i++) {
    healthSections[i].style.backgroundColor = "yellowgreen";
  }
} else if (health > 40 && health <= 60) {
  for (let i = 0; i < healthSections.length; i++) {
    healthSections[i].style.backgroundColor = "yellow";
  }
} else if (health > 20 && health <= 40) {
  for (let i = 0; i < healthSections.length; i++) {
    healthSections[i].style.backgroundColor = "orange";
  }
} else if (health >= 0 && health <= 20) {
  for (let i = 0; i < healthSections.length; i++) {
    healthSections[i].style.backgroundColor = "red";
  }
}
}

setInterval(() => {
  setTimeout(() => {
      //enemy collision with player
      for (let enemy of enemies) {
        if (enemy.position.distanceTo(controls.getObject().position) < 0.5) {
          health--;
          updateHealth();

        }
      }
    }, 50);
}, 50);


setInterval(() => {
  enemyNumber ++;
}, 5000);



animate();



//on window resize
window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
      }
    </script>
  </body>
</html>
